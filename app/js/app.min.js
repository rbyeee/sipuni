!function(){"use strict";document.addEventListener("DOMContentLoaded",function(){var e=new ScrollMagic.Controller,t=document.querySelectorAll(".step"),r=document.querySelectorAll(".step-image"),n=document.querySelector("#chronology");function o(e){console.log("Activating step:",e),t.forEach(function(e){return e.classList.remove("active")}),r.forEach(function(e){return e.classList.remove("active")});var n=document.querySelector('.step[data-step="'.concat(e,'"]')),o=document.querySelector('.step-image[data-step="'.concat(e,'"]'));n&&n.classList.add("active"),o&&o.classList.add("active")}function i(){return 200*window.innerHeight/100}var a=new ScrollMagic.Scene({triggerElement:"#chronology",triggerHook:"onLeave",duration:i()}).setPin(n).addTo(e).on("progress",function(e){var r=t.length;if(r){var n=1/r;o(Math.min(r-1,Math.floor(e.progress/n))+1)}});window.addEventListener("resize",function(){a.duration(i())}),t.forEach(function(e){e.addEventListener("click",function(){var e=Number(this.getAttribute("data-step")),r=t.length,a=i()/r,c=n.offsetTop+a*(e-1);window.scrollTo({top:c,behavior:"smooth"}),o(e)})}),o(1);var c=Array.from(document.querySelectorAll("[data-side-title]")),s=document.getElementById("sideNavList");if(s&&c.length){c.forEach(function(e){if(!e.id){var t=(e.getAttribute("data-side-title")||e.textContent||"section").toString().trim().toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9\-а-яё]/g,"").replace(/-+/g,"-").replace(/^-|-$/g,"");e.id=t||"section-".concat(Math.random().toString(36).slice(2,8))}var r=document.createElement("li");r.className="side-nav__item";var n=document.createElement("a");n.className="side-nav__link",n.href="#".concat(e.id),n.textContent=e.getAttribute("data-side-title")||e.textContent||"",r.appendChild(n),s.appendChild(r)});var l=Array.from(s.querySelectorAll(".side-nav__link"));l.forEach(function(e){e.addEventListener("click",function(t){t.preventDefault();var r=e.getAttribute("href").slice(1),n=document.getElementById(r);if(n){var o=n.getBoundingClientRect().top+window.pageYOffset-20;window.scrollTo({top:o,behavior:"smooth"})}})});var u=new IntersectionObserver(function(e){e.forEach(function(e){if(e.isIntersecting){var t=e.target.id;l.forEach(function(e){return e.classList.remove("active")});var r=s.querySelector('.side-nav__link[href="#'.concat(t,'"]'));r&&r.classList.add("active")}})},{root:null,rootMargin:"-35% 0px -55% 0px",threshold:0});c.forEach(function(e){return u.observe(e)})}else{var d=Array.from(document.querySelectorAll(".side-nav__link"));if(d.length){var f=d.map(function(e){return(e.getAttribute("href")||"").trim()}).filter(function(e){return e.startsWith("#")}).map(function(e){return document.querySelector(e)}).filter(Boolean);d.forEach(function(e){e.addEventListener("click",function(t){var r=e.getAttribute("href")||"";if(r.startsWith("#")){t.preventDefault();var n=document.querySelector(r);if(n){var o=n.getBoundingClientRect().top+window.pageYOffset-20;window.scrollTo({top:o,behavior:"smooth"})}}})});var v=new IntersectionObserver(function(e){e.forEach(function(e){if(e.isIntersecting){var t=e.target.id;if(t){d.forEach(function(e){return e.classList.remove("active")});var r=document.querySelector('.side-nav__link[href="#'.concat(t,'"]'));r&&r.classList.add("active")}}})},{root:null,rootMargin:"-35% 0px -55% 0px",threshold:0});f.forEach(function(e){return v.observe(e)})}}})}();